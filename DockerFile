# Base image — use Databricks-compatible or Spark-ready Python image
FROM python:3.10-slim

# Set working directory
WORKDIR /app

# Copy project files into container
COPY . /app

# Install dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Optional: install PySpark + Delta dependencies manually
RUN pip install pyspark==3.5.0 delta-spark==3.2.0 pyyaml requests

# Set environment variables
ENV PYTHONUNBUFFERED=1

# Default command — run extract stage as entrypoint
CMD ["python", "src/extract/save_raw.py"]
